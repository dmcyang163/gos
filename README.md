### 项目说明

#### 项目简介
这是一个基于 **点对点（P2P）网络** 的分布式聊天系统，使用 **Go 语言** 开发。每个节点可以直接与其他节点通信，支持 **消息广播**、**节点发现** 和 **心跳检测** 等功能。项目的目标是提供一个简单、轻量级的 P2P 通信示例，适合学习分布式系统和构建去中心化应用。

#### 核心功能
1. **点对点通信**：
   - 节点之间可以直接发送和接收消息，无需中央服务器。
   - 支持文本消息的实时传输。

2. **消息广播**：
   - 节点可以将消息广播到网络中所有连接的节点。
   - 适用于群聊或通知场景。

3. **节点发现**：
   - 自动发现网络中的其他节点，并维护节点列表。
   - 支持通过配置文件指定初始引导节点（Bootstrap Node）。

4. **心跳检测**：
   - 定期发送心跳消息，检测其他节点的健康状态。
   - 自动移除不活跃的节点，保持网络的稳定性。

5. **消息压缩**：
   - 使用 Snappy 算法压缩消息，减少网络传输的开销。
   - 提升消息传输的效率。

6. **日志管理**：
   - 支持日志轮转和压缩，避免日志文件过大。
   - 提供 HTTP API 动态调整日志级别，方便调试和监控。

#### 适用场景
- **学习分布式系统**：通过实践了解 P2P 网络的工作原理和实现方式。
- **构建去中心化应用**：作为去中心化聊天系统或消息传递系统的基础。
- **实验和扩展**：可以在此基础上添加更多功能，如加密通信、消息持久化等。

#### 快速开始

##### 1. 克隆项目
```bash
git clone https://github.com/dmcyang163/gos.git
cd gos
```

##### 2. 安装依赖
确保已安装 Go（版本 1.16 或更高），然后运行以下命令安装项目依赖：
```bash
go mod download
```

##### 3. 配置节点
编辑 `config.json` 文件，配置节点的端口、日志级别、心跳间隔等参数。示例配置如下：
```json
{
    "nodes": [
        {
            "id": "node_a",
            "port": "1234",
            "bootstrap_node": "",
            "max_conns": 100,
            "log_level": "info",
            "log_max_size": 100,
            "log_max_backups": 3,
            "log_max_age": 28,
            "log_compress": true,
            "discovery_interval": 10,
            "heartbeat_interval": 5,
            "log_api": "8080"
        }
    ]
}
```

##### 4. 启动节点
运行以下命令启动节点：
```bash
go run main.go config.json
```

##### 5. 启动多个节点（可选）
使用 `run-nodes.py` 脚本启动多个节点：
```bash
python run-nodes.py config.json
```

#### 使用方法

##### 1. 发送消息
启动节点后，在终端输入消息，消息会自动广播到所有连接的节点。

##### 2. 查看日志
日志默认保存在 `node.log` 中，支持日志轮转和压缩。可以通过日志文件查看节点的运行状态和消息记录。

##### 3. 动态调整日志级别
通过 HTTP API 动态调整日志级别，方便调试：
```bash
curl "http://localhost:8080/loglevel?level=debug"
```

##### 4. 节点发现
节点会自动发现网络中的其他节点，并维护节点列表。可以通过日志查看节点发现和连接状态。

##### 5. 心跳检测
节点会定期发送心跳消息，检测其他节点的健康状态。不活跃的节点会被自动移除。

#### 项目结构
```
p2p-chat-node/
├── config.go            # 配置文件加载
├── config.json          # 配置文件
├── compression.go       # 消息压缩
├── logger.go            # 日志管理
├── main.go              # 程序入口
├── msg.go               # 消息结构
├── msgHandler.go        # 消息处理器
├── msgRouter.go         # 消息路由器
├── network.go           # 网络通信
├── node.go              # 节点逻辑
├── peer.go              # 节点发现
└── README.md            # 项目文档
```

#### 未来计划
- **加密通信**：支持 TLS 加密，提升通信安全性。
- **消息持久化**：将消息保存到本地，防止丢失。
- **图形化界面**：提供一个简单的 UI，方便用户操作和监控。

#### 贡献与支持
欢迎提交 Issue 和 Pull Request！如果有问题或建议，请联系：dmc_yang@163.com

#### 许可证
本项目基于 Apache 许可证开源。详情请参阅 [LICENSE](LICENSE) 文件。

---

感谢您的关注！希望这个项目对您有所帮助。
```

---

### 特点
1. **详细全面**：涵盖了项目的背景、功能、使用方法、项目结构等内容。
2. **朴实低调**：语言简洁，没有过多的技术术语，适合初学者和非技术人员阅读。
3. **快速上手**：提供了详细的安装和使用指南，方便用户快速体验。
4. **结构清晰**：分为多个小部分，便于阅读和理解。
5. **未来展望**：列出了可能的改进方向，鼓励用户参与贡献。

这份项目说明适合用于向用户详细介绍项目，同时保持低调和实用性。